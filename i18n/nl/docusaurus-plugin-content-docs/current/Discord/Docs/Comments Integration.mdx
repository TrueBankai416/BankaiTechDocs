---
title: Integratie van opmerkingen
description: Complete handleiding voor het integreren van bidirectionele Discord-reacties met Docusaurus, inclusief installatie, configuratie en probleemoplossing.
image: /img/social/discord-social.jpg
sidebar_position: 2
---

# Integratie van Discord-reacties

Deze documentatiesite bevat een **bidirectionele Discord-commentaarintegratie** waarmee bezoekers reacties naar uw Discord-server kunnen sturen EN Discord-reacties op de website kunnen weergeven naast de bestaande GitHub-gebaseerde Giscus-commentaren.

## Functies

- **Bidirectionele communicatie**: reacties op de website â†’ Discord, antwoorden op Discord â†’ website
- **Dubbel reactiesysteem**: Zowel Giscus (gebaseerd op GitHub) als Discord-reacties werken samen.
- **Rich Discord Embeds**: Reacties worden weergegeven als opgemaakte embeds met volledige pagina-context.
- **Threadbeheer**: Automatische aanmaak van threads voor overzichtelijke reacties.
- **Realtime updates**: De website toont automatisch Discord-reacties.
- **Volledige paginacontext**: Opmerkingen bevatten de paginatitel, URL en navigatiecontext.
- **Gebruikersavatars**: In Discord-reacties worden gebruikersavatars en gebruikersnamen weergegeven.
- **Responsief ontwerp**: Werkt op zowel desktop- als mobiele apparaten.

## Installatie-instructies

### 1. Maak een Discord-bot aan.

1. Ga naar [Discord Developer Portal](https://discord.com/developers/applications)
2. Een nieuwe applicatie aanmaken
3. Ga naar het gedeelte "Bot" en maak een bot aan.
4. Kopieer het bottoken
5. Schakel onder 'Privileged Gateway Intents' het volgende in:
   - **Berichtinhoud en -doel**
   - **Serverleden intentie** (optioneel)

### 7. Implementatieconfiguratie

Je bot heeft de volgende machtigingen nodig:

- Berichten lezen
- Berichten verzenden
- Openbare discussies aanmaken
- Berichten verzenden in threads
- Lees de berichtgeschiedenis
- Gebruik slash-opdrachten (optioneel)

### 6. Start the Backend Server

1. Ga naar OAuth2 > URL-generator
2. Selecteer het bereik "bot".
3. Selecteer de hierboven vermelde machtigingen.
4. Gebruik de gegenereerde URL om de bot uit te nodigen naar je server.

### 5. Installeer serverafhankelijkheden

#### Frontend (.env)

```env
# Discord Bot Configuratie
DISCORD_BOT_TOKEN=jouw_bot_token_hier
DISCORD_CHANNEL_ID=jouw_kanaal_id_hier

# API Configuratie
REACT_APP_API_URL=http://localhost:3001

# Discord Context Configuratie
DISCORD_CONTEXT_LEVEL=volledig
DISCORD_BREADCRUMBS_WEERGEVEN=true
DISCORD_SECTION_INFO_WEERGEVEN=true
DISCORD_SITE_NAME=Jouw Sitenaam
```

#### Backendserver (server/.env)

```env
# Discord Bot Configuratie
DISCORD_BOT_TOKEN=jouw_bot_token_hier
DISCORD_CHANNEL_ID=jouw_kanaal_id_hier

# API Configuratie
PORT=3001

# Discord Context Configuratie
DISCORD_CONTEXT_LEVEL=volledig
DISCORD_SHOW_PAGE_CONTEXT=true
DISCORD_SHOW_BREADCRUMBS=true
DISCORD_SHOW_SECTION_INFO=true
DISCORD_SHOW_PAGE_PATH=false
DISCORD_SHOW_TIMESTAMP=true
DISCORD_SHOW_AUTHOR_FIELD=true
DISCORD_CREATE_THREADS=true
DISCORD_THREAD_DURATION=1440
DISCORD_SITE_NAME=Uw sitenaam
```

:::waarschuwing Beveiligingsnotitie

- Voeg nooit `.env`-bestanden toe aan versiebeheer.
- Gebruik omgevingsvariabelen in productie.
- Houd je bottoken veilig
  :::

### 6. Start de backendserver.

```bash
cd server
npm install
```

### 6. Start the Backend Server

```bash
# Ontwikkeling
npm run dev

# Productie
npm start
```

### 7. 7. Deploy Configuration

Voor implementaties in een productieomgeving stelt u de volgende omgevingsvariabelen in op uw hostingplatform:

- **Frontend**: Stel `REACT_APP_API_URL` in op de URL van uw productie-API.
- **Backend**: Implementeer de servermap met bottoken en kanaal-ID.
- **Database**: Er wordt automatisch een SQLite-database aangemaakt.
- **Context**: Configureer het Discord-contextniveau en de opties naar uw voorkeur.

## Hoe het werkt

### Volledige bidirectionele stroom

1. **Websitecommentaar**: Gebruiker dient commentaar in via websiteformulier
2. **Discord-bericht**: Bot stuurt opgemaakte embed naar Discord-kanaal met volledige pagina-inhoud
3. **Draad aanmaken**: De bot maakt automatisch een draad aan voor georganiseerde reacties.
4. **Discord-reacties**: Discord-gebruikers reageren in de thread of op het bericht.
5. **Databaseopslag**: De bot slaat alle opmerkingen en antwoorden op in een SQLite-database.
6. **Websiteweergave**: De frontend peilt elke 30 seconden de API en toont de antwoorden van Discord.

### Discord-berichtindeling

Discord-integraties omvatten:

- **Title**: "ğŸ’¬ New Comment: \{Page Title}"
- **Beschrijving**: De daadwerkelijke inhoud van de reactie
- **Auteur**: De naam van de reageerder
- **URL**: Klikbare link naar de exacte pagina
- **Paginaveld**: Toont de paginatitel met een klikbare link.
- **Tijdstempel**: Wanneer de reactie werd geplaatst
- **Thread**: Automatisch aangemaakte thread voor reacties

### Websiteweergave

De website toont:

- **Oorspronkelijke opmerkingen**: Inzendingen via het websiteformulier
- **Discord-reacties**: Reacties van Discord-gebruikers met avatars en gebruikersnamen
- **Realtime updates**: Automatische polling voor nieuwe reacties
- **Gestructureerde gesprekken**: Georganiseerde commentaar-â†’ antwoordstructuur

## Contextconfiguratie

### Contextniveaus

Stel in hoeveel context er in Discord-berichten wordt weergegeven:

#### `DISCORD_CONTEXT_LEVEL=minimal`

- **Toont**: Alleen de paginatitel en de inhoud van de reacties
- **Gebruiksscenario**: Duidelijke, eenvoudige berichten zonder extra context.

#### `DISCORD_CONTEXT_LEVEL=basic`

- **Toont**: Paginatitel, reactie-inhoud en klikbare pagina-URL
- **Gebruiksscenario**: Een context met beperkte informatie.

#### `DISCORD_CONTEXT_LEVEL=full` (standaard)

- **Toont**: Alle contextinformatie, inclusief breadcrumbs, secties en tijdstempels.
- **Gebruiksscenario**: Maximale context voor gedetailleerde discussies

#### `DISCORD_CONTEXT_LEVEL=custom`

- **Toont**: Alleen de contextelementen die u afzonderlijk inschakelt.
- **Gebruiksscenario**: Nauwkeurige controle over wat er verschijnt

### Individuele contextbesturingselementen

Wanneer je `DISCORD_CONTEXT_LEVEL=custom` gebruikt, kun je elk element afzonderlijk beheren:

```env
DISCORD_SHOW_PAGE_CONTEXT=true # Toon paginatitel en URL-veld
DISCORD_SHOW_BREADCRUMBS=true # Toon navigatiebreadcrumbs
DISCORD_SHOW_SECTION_INFO=true # Toon hoofdsectie (Docker, Nextcloud, etc.)
DISCORD_SHOW_PAGE_PATH=false # Toon volledig URL-pad
DISCORD_SHOW_TIMESTAMP=true # Toon wanneer reactie is geplaatst
DISCORD_SHOW_AUTHOR_FIELD=true # Toon naam van de reageerder als embed-auteur
```

### Draadconfiguratie

```env
DISCORD_CREATE_THREADS=true # Maak threads aan voor reacties
DISCORD_THREAD_DURATION=1440 # Tijd voor automatische archivering van threads (minuten)
DISCORD_SITE_NAME=Uw sitenaam # Sitenaam in de footer
```

### Voorbeeldcontextuitvoer

**Minimale context:**

```
Installatiehandleiding voor Docker
"Deze handleiding was erg nuttig! Hoe los ik poortconflicten op?"
```

**Basiscontext:**

```
ğŸ’¬ Docker Installatiehandleiding
"Deze handleiding was erg nuttig! Hoe los ik poortconflicten op?"
[Link naar pagina]
```

**Volledige context:**

```
ğŸ’¬ Nieuwe reactie: Docker installatiehandleiding
ğŸ‘¤ John Doe
"Deze handleiding was erg nuttig! Hoe los ik poortconflicten op?"

ğŸ“„ Pagina: Docker installatiehandleiding
ğŸ“ Navigatie: Docker > Documentatie > Docker installeren
ğŸ“‚ Sectie: Docker
ğŸ”— Pad: /Docker/Docs/Installing%20Docker/Docker%20Engine

Uw sitenaam â€¢ Reactiesysteem
```

## Aanpassing

### Styling

De component voor reacties op Discord maakt gebruik van CSS-modules. Je kunt het uiterlijk aanpassen door het volgende te wijzigen:

```
src/components/DiscordComments/styles.module.css
```

### Message Format

Om de insluitindeling van Discord aan te passen, bewerk je het object `discordMessage` in:

```
src/components/DiscordComments/index.tsx
```

### Componentplaatsing

De Discord-reacties verschijnen standaard onder de Giscus-reacties. Om dit te wijzigen, pas het volgende aan:

```
src/theme/DocItem/Layout/index.js
```

## Probleemoplossing

### De bot reageert niet.

1. **Controleer bottoken**: Zorg ervoor dat `DISCORD_BOT_TOKEN` correct is.
2. **Controleer de machtigingen**: Zorg ervoor dat de bot de vereiste machtigingen heeft in het kanaal.
3. **Controleer de kanaal-ID**: Zorg ervoor dat `DISCORD_CHANNEL_ID` correct is.
4. **Bot in server**: Controleer of de bot daadwerkelijk in je Discord-server aanwezig is.

### Reacties worden niet weergegeven

1. **Server draait**: Controleer of de backend-server op de juiste poort draait.
2. **API-URL**: Controleer of `REACT_APP_API_URL` naar uw backendserver verwijst.
3. **Database**: Controleer of er een SQLite-database wordt aangemaakt in de servermap.
4. **CORS**: Zorg ervoor dat CORS is geconfigureerd voor uw frontend-domein.

### Reacties op Discord worden niet weergegeven

1. **Berichtinhoud Intentie**: Zorg ervoor dat dit is ingeschakeld in de Discord-ontwikkelaarsportal.
2. **Botrechten**: Controleer of de bot berichten in het kanaal kan lezen.
3. **Databaseverbinding**: Controleer de serverlogboeken op databasefouten.
4. **Peiling**: Er worden elke 30 seconden polls op de frontend weergegeven - het kan even duren voordat de antwoorden verschijnen.

### Omgevingsvariabelen werken niet

- **Ontwikkeling**: Herstart zowel de frontend- als de backendservers.
- **Productie**: Herimplementeer zowel de frontend als de backend met de juiste omgevingsvariabelen.
- **Voorvoegsel**: Gebruik het voorvoegsel `REACT_APP_` alleen voor frontend-variabelen.

### Databaseproblemen

1. **Bestandsrechten**: Zorg ervoor dat de server schrijfrechten heeft in de databasedirectory.
2. **Schijfruimte**: Controleer de beschikbare schijfruimte voor de SQLite-database.
3. **Serverlogboeken**: Controleer de serverconsole op fouten in de databaseverbinding.

## Beveiligingsaspecten

- **Bot-token**: Houd uw bot-token geheim en voeg deze nooit toe aan versiebeheer.
- **Snelheidsbeperking**: Discord hanteert snelheidsbeperkingen voor bots (anders dan voor webhooks).
- **Invoervalidatie**: Zowel de frontend als de backend valideren de gebruikersinvoer.
- **Databasebeveiliging**: De SQLite-database moet worden beschermd met de juiste bestandsrechten.
- **API-beveiliging**: Overweeg het instellen van een snelheidsbeperking (rate limiting) op uw API-eindpunten.
- **CORS**: Configureer CORS correct voor uw productiedomein.

## Architectuur

```
Website Frontend â†â†’ Express API â†â†’ Discord Bot â†â†’ Discord Server
                    â†“
                SQLite Database
```

## Bestandsstructuur

```
project/
â”œâ”€â”€ src/components/DiscordComments/ # Frontend-component
â”œâ”€â”€ server/ # Backend-server
â”‚ â”œâ”€â”€ api.js # Express API-server
â”‚ â”œâ”€â”€ discord-bot.js # Discord-botlogica
â”‚ â”œâ”€â”€ database.js # SQLite-databasefuncties
â”‚ â””â”€â”€ package.json # Serverafhankelijkheden
â””â”€â”€ docs/Discord/Docs/ # Documentatie
```

## Browserondersteuning

De Discord-commentaarfunctie werkt in alle moderne browsers die het volgende ondersteunen:

- ES6 fetch API
- React 18+
- CSS Grid en Flexbox
- Lokale opslag (voor het bewaren van formulieren)
