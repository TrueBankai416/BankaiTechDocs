---
title: שילוב תגובות
description: מדריך מלא לשילוב תגובות דו-כיווניות בדיסקורד עם Docusaurus כולל הגדרה, תצורה ופתרון בעיות.
image: /img/social/discord-social.jpg
sidebar_position: 2
---

# שילוב תגובות בדיסקורד

אתר תיעוד זה כולל **שילוב דו-כיווני של תגובות דיסקורד** המאפשר למבקרים לשלוח תגובות לשרת דיסקורד שלכם וגם להציג תשובות דיסקורד באתר לצד תגובות גיסקוס קיימות מבוססות GitHub.

## תכונות

* **תקשורת דו-כיוונית**: תגובות לאתר → דיסקורד, תשובות דיסקורד → אתר
* **מערכת תגובות כפולה**: גם תגובות של Giscus (מבוססות GitHub) וגם תגובות של Discord פועלות יחד.
* **הטמעות עשירות בדיסקורד**: תגובות מופיעות כהטמעות מעוצבים עם הקשר מלא של הדף
* **ניהול שרשורים**: יצירת שרשורים אוטומטית לתגובות מאורגנות
* **עדכונים בזמן אמת**: האתר מציג תשובות דיסקורד באופן אוטומטי
* **הקשר מלא של הדף**: ההערות כוללות את כותרת הדף, כתובת האתר והקשר הניווט
* **אווטארים של משתמשים**: תגובות דיסקורד מציגות אווטארים ושמות משתמש של משתמשים
* **עיצוב רספונסיבי**: עובד גם על מחשבים שולחניים וגם על מכשירים ניידים

## הוראות התקנה

### 1. צור בוט דיסקורד

1. עבור אל [פורטל המפתחים של דיסקורד](https://discord.com/developers/applications)
2. צור יישום חדש
3. עבור אל הקטע "בוט" וצור בוט
4. העתק את אסימון הבוט
5. תחת "כוונות שער מורשות", הפעל:
   * **כוונת תוכן ההודעה**
   * **כוונת חברי השרת** (אופציונלי)

### 2) הגדרת הרשאות בוט

הבוט שלך זקוק להרשאות הבאות:

* קרא הודעות
* שלח הודעות
* צור שרשורים ציבוריים
* שלח הודעות בשרשורים
* קרא היסטוריית הודעות
* השתמש בפקודות סלאש (אופציונלי)

### 3. הזמן את הבוט לשרת

1. עבור אל OAuth2 > מחולל כתובות URL
2. בחר טווח "בוט"
3. בחר את ההרשאות המפורטות למעלה
4. השתמש בכתובת ה-URL שנוצרה כדי להזמין את הבוט לשרת שלך

### 4) הגדרת משתני סביבה

#### ממשק קצה (.env)

```env
# תצורת בוט של דיסקורד
DISCORD_BOT_TOKEN=אסימון_הבוט_שלך_כאן
DISCORD_CHANNEL_ID=מזהה_הערוץ_שלך_כאן

# תצורת API
REACT_APP_API_URL=http://localhost:3001

# תצורת הקשר של דיסקורד
DISCORD_CONTEXT_LEVEL=full
DISCORD_SHOW_BREADCRUMBS=true
DISCORD_SHOW_SECTION_INFO=true
DISCORD_SITE_NAME=שם האתר שלך
```

#### שרת Backend (server/.env)

```env
# תצורת בוט של דיסקורד
DISCORD_BOT_TOKEN=אסימון_הבוט_שלך_כאן
DISCORD_CHANNEL_ID=מזהה_הערוץ_שלך_כאן

# תצורת API
PORT=3001

# תצורת הקשר של דיסקורד
DISCORD_CONTEXT_LEVEL=מלא
DISCORD_SHOW_PAGE_CONTEXT=נכון
DISCORD_SHOW_BREADCRUMBS=נכון
DISCORD_SHOW_SECTION_INFO=נכון
DISCORD_SHOW_PAGE_PATH=שקר
DISCORD_SHOW_TIMESTAMP=נכון
DISCORD_SHOW_AUTHOR_FIELD=נכון
DISCORD_CREATE_THREADS=נכון
DISCORD_THREAD_DURATION=1440
DISCORD_SITE_NAME=שם האתר שלך
```

:::אזהרה הערת אבטחה

* לעולם אל תעביר קבצי `.env` לבקרת גרסאות
* שימוש במשתני סביבה בתהליכי ייצור
* שמור על אבטחת אסימון הבוט שלך
  :::

### 5. התקנת תלויות שרת

```bash
שרת cd
התקנת npm
```

### 6. הפעל את שרת ה-backend

```bash
# פיתוח
npm run dev

# ייצור
npm start
```

### 7. פריסת תצורה

עבור פריסות ייצור, הגדר משתני סביבה בפלטפורמת האירוח שלך:

* **ממשק קצה**: הגדר `REACT_APP_API_URL` לכתובת ה-URL של ה-API של הייצור שלך
* **Backend**: פריסת תיקיית השרת עם אסימון הבוט ומזהה הערוץ
* **מסד נתונים**: מסד הנתונים של SQLite ייווצר באופן אוטומטי
* **הקשר**: הגדרת רמת ההקשר והאפשרויות של דיסקורד בהתאם להעדפותיך

## איך זה עובד

### זרימה דו-כיוונית מלאה

1. **תגובה לאתר**: המשתמש שולח תגובה באמצעות טופס באתר
2. **הודעת דיסקורד**: בוט שולח הטמעה מעוצבת לערוץ דיסקורד עם הקשר מלא של הדף
3. **יצירת שרשור**: בוט יוצר אוטומטית שרשור לתגובות מאורגנות
4. **תגובות דיסקורד**: משתמשי דיסקורד מגיבים בשרשור או להודעה
5. **אחסון מסד נתונים**: הבוט מאחסן את כל התגובות והתשובות במסד הנתונים של SQLite
6. **תצוגת אתר**: סקרים ב-API של Frontend כל 30 שניות ומציג תשובות דיסקורד

### פורמט הודעת דיסקורד

הטמעות דיסקורד כוללות:

* **Title**: "💬 New Comment: \{Page Title}"
* **תיאור**: תוכן התגובה בפועל
* **מחבר**: שם המגיב
* **קישור**: קישור לדף המדויק
* **שדה עמוד**: מציג את כותרת העמוד עם קישור הניתן ללחיצה
* **חותמת זמן**: מתי פורסמה התגובה
* **שרשור**: שרשור שנוצר אוטומטית לתגובות

### תצוגת אתר אינטרנט

האתר מציג:

* **הערות מקוריות**: הגשת טופס לאתר
* **תגובות דיסקורד**: תגובות ממשתמשי דיסקורד עם אווטארים ושמות משתמש
* **עדכונים בזמן אמת**: סקר אוטומטי לתשובות חדשות
* **שיחות משורשרות**: תגובה מאורגנת → מבנה תשובה

## תצורת הקשר

### רמות הקשר

הגדר כמה הקשר יופיע בהודעות דיסקורד:

#### `DISCORD_CONTEXT_LEVEL=מינימלי`

* **הצגות**: רק כותרת העמוד ותוכן התגובות
* **תרחיש שימוש**: הודעות נקיות ופשוטות ללא הקשר נוסף

#### `DISCORD_CONTEXT_LEVEL=בסיסי`

* **מציג**: כותרת העמוד, תוכן התגובות וכתובת URL של העמוד הניתנת ללחיצה
* **מקרה שימוש**: הקשר מתון עם מידע חיוני

#### `DISCORD_CONTEXT_LEVEL=full` (ברירת מחדל)

* **מציג**: כל מידע ההקשר כולל פירורי לחם, מדורים וחותמות זמן
* **מקרה שימוש**: הקשר מקסימלי לדיונים מפורטים

#### `DISCORD_CONTEXT_LEVEL=מותאם אישית`

* **מציג**: רק את רכיבי ההקשר שאתה מפעיל בנפרד
* **תרחיש שימוש**: שליטה מכוונת על מה שמופיע

### בקרות הקשר אישיות

בעת שימוש ב-`DISCORD_CONTEXT_LEVEL=custom`, ניתן לשלוט בכל אלמנט:

```env
DISCORD_SHOW_PAGE_CONTEXT=true # הצג את כותרת העמוד ושדה כתובת ה-URL
DISCORD_SHOW_BREADCRUMBS=true # הצג פירורי לחם לניווט
DISCORD_SHOW_SECTION_INFO=true # הצג את המדור הראשי (Docker, Nextcloud וכו')
DISCORD_SHOW_PAGE_PATH=false # הצג את נתיב ה-URL המלא
DISCORD_SHOW_TIMESTAMP=true # הצג מתי פורסמה התגובה
DISCORD_SHOW_AUTHOR_FIELD=true # הצג את שם המגיב ככותב ההטמעה
```

### תצורת חוט

```env
DISCORD_CREATE_THREADS=true # צור שרשורים לתגובות
DISCORD_THREAD_DURATION=1440 # זמן ארכיון אוטומטי של השרשור (בדקות)
DISCORD_SITE_NAME=שם האתר שלך # שם האתר בתחתית העמוד
```

### דוגמאות לפלטי הקשר

**הקשר מינימלי:**

```
מדריך התקנה של Docker
"מדריך זה היה ממש מועיל! איך אני מטפל בקונפליקטים של פורטים?"
```

**הקשר בסיסי:**

```
💬 מדריך התקנה של Docker
"המדריך הזה היה ממש מועיל! איך אני מטפל בקונפליקטים של פורטים?"
[קישור לדף]
```

**הקשר מלא:**

```
💬 תגובה חדשה: מדריך התקנת Docker
👤 ג'ון דו
"המדריך הזה היה ממש מועיל! איך אני מטפל בקונפליקטים של פורטים?"

📄 עמוד: מדריך התקנת Docker
📍 ניווט: Docker > מסמכים > התקנת Docker
📂 מדור: Docker
🔗 נתיב: /Docker/Docs/Installing%20Docker/Docker%20Eengine

שם האתר שלך • מערכת תגובות
```

## התאמה אישית

### סִגנוּן

רכיב התגובות של דיסקורד משתמש במודולי CSS. ניתן להתאים אישית את המראה על ידי שינוי:

```
src/components/DiscordComments/styles.module.css
```

### פורמט הודעה

כדי להתאים אישית את פורמט ההטמעה של Discord, ערכו את האובייקט `discordMessage` ב:

```
src/components/DiscordComments/index.tsx
```

### מיקום רכיבים

תגובות הדיסקורד מופיעות כברירת מחדל מתחת לתגובות גיסקוס. כדי לשנות זאת, ערכו:

```
src/theme/DocItem/Layout/index.js
```

## פתרון בעיות

### הבוט לא מגיב

1. **בדיקת אסימון בוט**: ודא ש-`DISCORD_BOT_TOKEN` נכון
2. **אמת הרשאות**: ודא שלבוט יש את ההרשאות הנדרשות בערוץ
3. **בדיקת מזהה הערוץ**: ודא ש-`DISCORD_CHANNEL_ID` נכון
4. **בוט בשרת**: ודא שהבוט אכן נמצא בשרת הדיסקורד שלך

### תגובות לא מופיעות

1. **שרת פועל**: בדוק אם שרת ה-backend פועל בפורט הנכון
2. **כתובת URL של API**: אימות ש-`REACT_APP_API_URL` מצביע על שרת ה-backend שלך
3. **מסד נתונים**: בדוק אם מסד נתונים של SQLite נוצר בתיקיית השרת
4. **CORS**: ודא ש-CORS מוגדר עבור דומיין הקצה הקדמי שלך

### תגובות דיסקורד לא מוצגות

1. **כוונת תוכן הודעה**: ודא שהאפשרות הזו מופעלת בפורטל המפתחים של דיסקורד
2. **הרשאות בוט**: אימות שהבוט יכול לקרוא הודעות בערוץ
3. **חיבור למסד נתונים**: בדוק את יומני השרת לאיתור שגיאות במסד הנתונים
4. **סקרים**: סקרים קדמיים כל 30 שניות - ייתכן שיחלוף זמן עד להופעת התשובות

### משתני סביבה לא פועלים

* **פיתוח**: הפעלה מחדש של שרתי הקצה הקדמי והקצה האחורי
* **ייצור**: פריסה מחדש של הקצה הקדמי והקצה האחורי עם משתני סביבה נכונים
* **קידומת**: השתמש בקידומת `REACT_APP_` רק עבור משתני ממשק משתמש

### בעיות במסד הנתונים

1. **הרשאות קובץ**: ודא שהשרת יכול לכתוב לתיקיית מסד הנתונים
2. **שטח דיסק**: בדוק שטח דיסק פנוי עבור מסד הנתונים SQLite
3. **יומני שרת**: בדוק את קונסולת השרת לאיתור שגיאות חיבור למסד הנתונים

## שיקולי אבטחה

* **אסימון בוט**: שמור את אסימון הבוט שלך בסוד ואל תעביר אותו לעולם לבקרת גרסאות
* **הגבלת קצב**: לדיסקורד יש מגבלות קצב עבור בוטים (שונות מ-webhooks)
* **אימות קלט**: גם הקצה הקדמי וגם הקצה האחורי מאמתים קלט מהמשתמש
* **אבטחת מסד נתונים**: יש להגן על מסד הנתונים SQLite באמצעות הרשאות קבצים מתאימות
* **אבטחת API**: שקלו ליישם הגבלת קצב בנקודות הקצה של ה-API שלכם
* **CORS**: קבע את ההגדרה של CORS כראוי עבור תחום הייצור שלך

## אַדְרִיכָלוּת

```
ממשק חזית אתר ←→ Express API ←→ Discord Bot ←→ Discord Server
                    ↓
                מסד נתונים SQLite
```

## מבנה הקובץ

```
project/
├── src/components/DiscordComments/ # רכיב Frontend
├── server/ # שרת Backend
│ ├── api.js # שרת Express API
│ ├── discord-bot.js # לוגיקת בוט של Discord
│ ├── database.js # פונקציות מסד נתונים SQLite
│ └── package.json # תלויות שרת
└── docs/Discord/Docs/ # תיעוד
```

## תמיכה בדפדפנים

רכיב התגובות של דיסקורד עובד בכל הדפדפנים המודרניים התומכים ב:

* ממשק API של אחזור ES6
* ריאקט 18+
* רשת CSS ו-Flexbox
* אחסון מקומי (לשמירה על טופס)
