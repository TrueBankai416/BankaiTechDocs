---
title: Integrace komentÃ¡Å™Å¯
description: KompletnÃ­ prÅ¯vodce integracÃ­ obousmÄ›rnÃ½ch komentÃ¡Å™Å¯ Discordu s Docusaurusem, vÄetnÄ› nastavenÃ­, konfigurace a Å™eÅ¡enÃ­ problÃ©mÅ¯.
image: /img/social/discord-social.jpg
sidebar_position: 2
---

# Integrace komentÃ¡Å™Å¯ na Discordu

Tato dokumentaÄnÃ­ strÃ¡nka obsahuje **obousmÄ›rnou integraci komentÃ¡Å™Å¯ Discordu**, kterÃ¡ umoÅ¾Åˆuje nÃ¡vÅ¡tÄ›vnÃ­kÅ¯m odesÃ­lat komentÃ¡Å™e na vÃ¡Å¡ Discord server A ZÃROVEÅ‡ zobrazovat odpovÄ›di z Discordu na webu spolu se stÃ¡vajÃ­cÃ­mi komentÃ¡Å™i Giscus zaloÅ¾enÃ½mi na GitHubu.

## Funkce

* **ObousmÄ›rnÃ¡ komunikace**: KomentÃ¡Å™e na webu â†’ Discord, OdpovÄ›di na Discordu â†’ Web
* **SystÃ©m duÃ¡lnÃ­ch komentÃ¡Å™Å¯**: KomentÃ¡Å™e z Giscusu (zaloÅ¾enÃ©ho na GitHubu) i Discordu fungujÃ­ spoleÄnÄ›.
* **RozÅ¡Ã­Å™enÃ© vloÅ¾enÃ© pÅ™Ã­spÄ›vky na Discordu**: KomentÃ¡Å™e se zobrazujÃ­ jako formÃ¡tovanÃ© vloÅ¾enÃ© pÅ™Ã­spÄ›vky s kontextem celÃ© strÃ¡nky
* **SprÃ¡va vlÃ¡ken**: AutomatickÃ© vytvÃ¡Å™enÃ­ vlÃ¡ken pro organizovanÃ© odpovÄ›di
* **Aktualizace v reÃ¡lnÃ©m Äase**: WebovÃ© strÃ¡nky automaticky zobrazujÃ­ odpovÄ›di na Discordu
* **Kontext celÃ© strÃ¡nky**: KomentÃ¡Å™e zahrnujÃ­ nÃ¡zev strÃ¡nky, URL a kontext navigace
* **UÅ¾ivatelskÃ© avatary**: OdpovÄ›di na Discordu zobrazujÃ­ uÅ¾ivatelskÃ© avatary a uÅ¾ivatelskÃ¡ jmÃ©na
* **ResponzivnÃ­ design**: Funguje na stolnÃ­ch poÄÃ­taÄÃ­ch i mobilnÃ­ch zaÅ™Ã­zenÃ­ch

## Pokyny k nastavenÃ­

### 1. VytvoÅ™te Discord Bot

1. PÅ™ejdÄ›te na [PortÃ¡l vÃ½vojÃ¡Å™Å¯ Discordu](https://discord.com/developers/applications)
2. VytvoÅ™te novou aplikaci
3. PÅ™ejdÄ›te do sekce â€Botâ€œ a vytvoÅ™te bota.
4. ZkopÃ­rujte token bota
5. V ÄÃ¡sti â€PrivilegovanÃ© zÃ¡mÄ›ry brÃ¡nyâ€œ povolte:
   * **ZÃ¡mÄ›r obsahu zprÃ¡vy**
   * **ZÃ¡mÄ›r ÄlenÅ¯ serveru** (volitelnÃ©)

### 2) Konfigurace oprÃ¡vnÄ›nÃ­ bota

VÃ¡Å¡ bot potÅ™ebuje tato oprÃ¡vnÄ›nÃ­:

* ÄŒÃ­st zprÃ¡vy
* OdesÃ­lat zprÃ¡vy
* VytvÃ¡Å™et veÅ™ejnÃ¡ vlÃ¡kna
* PosÃ­lat zprÃ¡vy ve vlÃ¡knech
* ÄŒÃ­st historii zprÃ¡v
* PouÅ¾itÃ­ pÅ™Ã­kazÅ¯ s lomÃ­tkem (volitelnÃ©)

### 3. Pozvat bota na server

1. PÅ™ejdÄ›te do sekce OAuth2 > GenerÃ¡tor URL adres
2. Vyberte rozsah â€botâ€œ
3. Vyberte vÃ½Å¡e uvedenÃ¡ oprÃ¡vnÄ›nÃ­
4. PomocÃ­ vygenerovanÃ© adresy URL pozvÄ›te bota na vÃ¡Å¡ server.

### 4) Konfigurace promÄ›nnÃ½ch prostÅ™edÃ­

#### Frontend (.env)

```env
# Konfigurace bota Discordu
DISCORD_BOT_TOKEN=zde vÃ¡Å¡_token_bota
DISCORD_CHANNEL_ID=zde vaÅ¡e_id_kanÃ¡lu

# Konfigurace API
REACT_APP_API_URL=http://localhost:3001

# Konfigurace kontextu Discordu
DISCORD_CONTEXT_LEVEL=full
DISCORD_SHOW_BREADCRUMBS=true
DISCORD_SHOW_SECTION_INFO=true
DISCORD_SITE_NAME=NÃ¡zev vaÅ¡eho webu
```

#### BackendovÃ½ server (server/.env)

```env
# Konfigurace bota Discordu
DISCORD_BOT_TOKEN=zde vÃ¡Å¡_token_bota
DISCORD_CHANNEL_ID=zde vaÅ¡e_id_kanÃ¡lu

# Konfigurace API
PORT=3001

# Konfigurace kontextu Discordu
DISCORD_CONTEXT_LEVEL=full
DISCORD_SHOW_PAGE_CONTEXT=true
DISCORD_SHOW_BREADCRUMBS=true
DISCORD_SHOW_SECTION_INFO=true
DISCORD_SHOW_PAGE_PATH=false
DISCORD_SHOW_TIMESTAMP=true
DISCORD_SHOW_AUTHOR_FIELD=true
DISCORD_CREATE_THREADS=true
DISCORD_THREAD_DURATION=1440
DISCORD_SITE_NAME=NÃ¡zev vaÅ¡eho webu
```

:::warning BezpeÄnostnÃ­ poznÃ¡mka

* Nikdy neposkytovat soubory `.env` do systÃ©mu sprÃ¡vy verzÃ­
* PouÅ¾itÃ­ promÄ›nnÃ½ch prostÅ™edÃ­ v produkÄnÃ­m prostÅ™edÃ­
* ChraÅˆte svÅ¯j token bota
  :::

### 5. Instalace zÃ¡vislostÃ­ serveru

```bash
cd server
instalace npm
```

### 6. SpuÅ¡tÄ›nÃ­ backendovÃ©ho serveru

```bash
# VÃ½voj
spuÅ¡tÄ›nÃ­ npm dev

# Produkce
spuÅ¡tÄ›nÃ­ npm
```

### 7. Konfigurace nasazenÃ­

Pro produkÄnÃ­ nasazenÃ­ nastavte promÄ›nnÃ© prostÅ™edÃ­ na vaÅ¡Ã­ hostitelskÃ© platformÄ›:

* **Frontend**: Nastavte `REACT_APP_API_URL` na URL vaÅ¡Ã­ produkÄnÃ­ API
* **Backend**: NasaÄte sloÅ¾ku serveru s tokenem bota a ID kanÃ¡lu
* **DatabÃ¡ze**: DatabÃ¡ze SQLite bude vytvoÅ™ena automaticky
* **Kontext**: Nastavte ÃºroveÅˆ kontextu a moÅ¾nosti Discordu podle svÃ½ch preferencÃ­

## Jak to funguje

### KompletnÃ­ obousmÄ›rnÃ½ tok

1. **KomentÃ¡Å™ na webu**: UÅ¾ivatel odeÅ¡le komentÃ¡Å™ prostÅ™ednictvÃ­m formulÃ¡Å™e na webu
2. **ZprÃ¡va na Discordu**: Bot odesÃ­lÃ¡ formÃ¡tovanÃ½ vloÅ¾enÃ½ obsah do kanÃ¡lu Discord s kontextem celÃ© strÃ¡nky
3. **VytvÃ¡Å™enÃ­ vlÃ¡kna**: Bot automaticky vytvÃ¡Å™Ã­ vlÃ¡kno pro uspoÅ™Ã¡danÃ© odpovÄ›di
4. **OdpovÄ›di na Discordu**: UÅ¾ivatelÃ© Discordu odpovÃ­dajÃ­ ve vlÃ¡knÄ› nebo na zprÃ¡vu
5. **ÃšloÅ¾iÅ¡tÄ› databÃ¡ze**: Bot uklÃ¡dÃ¡ vÅ¡echny komentÃ¡Å™e a odpovÄ›di do databÃ¡ze SQLite
6. **ZobrazenÃ­ webovÃ½ch strÃ¡nek**: Frontend kaÅ¾dÃ½ch 30 sekund dotazuje API a zobrazuje odpovÄ›di na Discordu

### FormÃ¡t zprÃ¡vy na Discordu

Mezi vloÅ¾enÃ© pÅ™Ã­spÄ›vky na Discordu patÅ™Ã­:

* **Title**: "ğŸ’¬ New Comment: \{Page Title}"
* **Popis**: SkuteÄnÃ½ obsah komentÃ¡Å™e
* **Autor**: JmÃ©no komentujÃ­cÃ­ho
* **URL**: KliknutelnÃ½ odkaz na pÅ™esnou strÃ¡nku
* **Pole strÃ¡nky**: Zobrazuje nÃ¡zev strÃ¡nky s odkazem, na kterÃ½ lze kliknout
* **ÄŒasovÃ© razÃ­tko**: Kdy byl komentÃ¡Å™ zveÅ™ejnÄ›n
* **VlÃ¡kno**: Automaticky vytvoÅ™enÃ© vlÃ¡kno pro odpovÄ›di

### ZobrazenÃ­ webovÃ½ch strÃ¡nek

WebovÃ¡ strÃ¡nka ukazuje:

* **PÅ¯vodnÃ­ komentÃ¡Å™e**: OdeslÃ¡nÃ­ formulÃ¡Å™e na webu
* **OdpovÄ›di na Discordu**: OdpovÄ›di od uÅ¾ivatelÅ¯ Discordu s avatary a uÅ¾ivatelskÃ½mi jmÃ©ny
* **Aktualizace v reÃ¡lnÃ©m Äase**: AutomatickÃ© dotazovÃ¡nÃ­ na novÃ© odpovÄ›di
* **VlÃ¡knovÃ© konverzace**: OrganizovanÃ½ komentÃ¡Å™ â†’ struktura odpovÄ›dÃ­

## Konfigurace kontextu

### ÃšrovnÄ› kontextu

Nastavte, kolik kontextu se bude zobrazovat ve zprÃ¡vÃ¡ch na Discordu:

#### `DISCORD_CONTEXT_LEVEL=minimÃ¡lnÃ­`

* **Zobrazuje**: Pouze nÃ¡zev strÃ¡nky a obsah komentÃ¡Å™e
* **PÅ™Ã­pad pouÅ¾itÃ­**: ÄŒistÃ©, jednoduchÃ© zprÃ¡vy bez zbyteÄnÃ©ho kontextu

#### `DISCORD_CONTEXT_LEVEL=zÃ¡kladnÃ­`

* **Zobrazuje**: NÃ¡zev strÃ¡nky, obsah komentÃ¡Å™e a klikatelnou URL strÃ¡nku
* **PÅ™Ã­pad pouÅ¾itÃ­**: StÅ™ednÃ­ kontext sÂ dÅ¯leÅ¾itÃ½mi informacemi

#### `DISCORD_CONTEXT_LEVEL=plnÃ¡` (vÃ½chozÃ­)

* **Zobrazuje**: VeÅ¡kerÃ© kontextovÃ© informace vÄetnÄ› navigace, sekcÃ­ a ÄasovÃ½ch razÃ­tek
* **PÅ™Ã­pad pouÅ¾itÃ­**: MaximÃ¡lnÃ­ kontext pro podrobnÃ© diskuse

#### `DISCORD_CONTEXT_LEVEL=vlastnÃ­`

* **Zobrazuje**: Pouze kontextovÃ© prvky, kterÃ© povolÃ­te jednotlivÄ›.
* **PÅ™Ã­pad pouÅ¾itÃ­**: JemnÃ© ovlÃ¡dÃ¡nÃ­ zobrazenÃ­

### JednotlivÃ© ovlÃ¡dacÃ­ prvky kontextu

PÅ™i pouÅ¾itÃ­ `DISCORD_CONTEXT_LEVEL=custom` mÅ¯Å¾ete ovlÃ¡dat kaÅ¾dÃ½ prvek:

```env
DISCORD_SHOW_PAGE_CONTEXT=true # Zobrazit nÃ¡zev strÃ¡nky a pole URL
DISCORD_SHOW_BREADCRUMBS=true # Zobrazit navigaÄnÃ­ breadcrumbs
DISCORD_SHOW_SECTION_INFO=true # Zobrazit hlavnÃ­ sekci (Docker, Nextcloud atd.)
DISCORD_SHOW_PAGE_PATH=false # Zobrazit Ãºplnou cestu URL
DISCORD_SHOW_TIMESTAMP=true # Zobrazit, kdy byl komentÃ¡Å™ zveÅ™ejnÄ›n
DISCORD_SHOW_AUTHOR_FIELD=true # Zobrazit jmÃ©no komentujÃ­cÃ­ho jako autora vloÅ¾enÃ©ho pÅ™Ã­spÄ›vku
```

### Konfigurace vlÃ¡kna

```env
DISCORD_CREATE_THREADS=true # VytvoÅ™it vlÃ¡kna pro odpovÄ›di
DISCORD_THREAD_DURATION=1440 # Doba automatickÃ© archivace vlÃ¡kna (minuty)
DISCORD_SITE_NAME=NÃ¡zev vaÅ¡eho webu # NÃ¡zev webu v zÃ¡patÃ­
```

### PÅ™Ã­klad kontextovÃ½ch vÃ½stupÅ¯

**MinimÃ¡lnÃ­ kontext:**

```
PrÅ¯vodce instalacÃ­ Dockeru
â€Tento nÃ¡vod byl opravdu uÅ¾iteÄnÃ½! Jak Å™eÅ¡Ã­m konflikty portÅ¯?â€œ
```

**ZÃ¡kladnÃ­ kontext:**

```
ğŸ’¬ PrÅ¯vodce instalacÃ­ Dockeru
â€Tento nÃ¡vod byl opravdu uÅ¾iteÄnÃ½! Jak Å™eÅ¡Ã­m konflikty portÅ¯?â€œ
[Odkaz na strÃ¡nku]
```

**CelÃ½ kontext:**

```
ğŸ’¬ NovÃ½ komentÃ¡Å™: PrÅ¯vodce instalacÃ­ Dockeru
ğŸ‘¤ Jan NovÃ¡k
â€Tento nÃ¡vod byl opravdu uÅ¾iteÄnÃ½! Jak Å™eÅ¡Ã­m konflikty portÅ¯?â€œ

ğŸ“„ StrÃ¡nka: PrÅ¯vodce instalacÃ­ Dockeru
ğŸ“ Navigace: Docker > Dokumentace > Instalace Dockeru
ğŸ“‚ Sekce: Docker
ğŸ”— Cesta: /Docker/Dokumentace/Instalace%20Docker/Docker%20Eengine

NÃ¡zev vaÅ¡eho webu â€¢ SystÃ©m komentÃ¡Å™Å¯
```

## PÅ™izpÅ¯sobenÃ­

### Styling

Komponenta komentÃ¡Å™Å¯ na Discordu pouÅ¾Ã­vÃ¡ CSS moduly. Vzhled si mÅ¯Å¾ete pÅ™izpÅ¯sobit Ãºpravou:

```
src/components/DiscordComments/styles.module.css
```

### FormÃ¡t zprÃ¡vy

Chcete-li pÅ™izpÅ¯sobit formÃ¡t vklÃ¡dÃ¡nÃ­ na Discord, upravte objekt `discordMessage` v:

```
src/components/DiscordComments/index.tsx
```

### UmÃ­stÄ›nÃ­ komponent

KomentÃ¡Å™e na Discordu se standardnÄ› zobrazujÃ­ pod komentÃ¡Å™i na Giscusu. Chcete-li to zmÄ›nit, upravte:

```
src/theme/DocItem/Layout/index.js
```

## OdstraÅˆovÃ¡nÃ­ problÃ©mÅ¯

### Bot neodpovÃ­dÃ¡

1. **Zkontrolujte token bota**: UjistÄ›te se, Å¾e je `DISCORD_BOT_TOKEN` sprÃ¡vnÃ½
2. **OvÄ›Å™enÃ­ oprÃ¡vnÄ›nÃ­**: UjistÄ›te se, Å¾e mÃ¡ bot v kanÃ¡lu poÅ¾adovanÃ¡ oprÃ¡vnÄ›nÃ­.
3. **Zkontrolujte ID kanÃ¡lu**: UjistÄ›te se, Å¾e je `DISCORD_CHANNEL_ID` sprÃ¡vnÃ©
4. **Bot na serveru**: OvÄ›Å™te, zda je bot skuteÄnÄ› na vaÅ¡em Discord serveru

### KomentÃ¡Å™e se nezobrazujÃ­

1. **Server spuÅ¡tÄ›n**: Zkontrolujte, zda backendovÃ½ server bÄ›Å¾Ã­ na sprÃ¡vnÃ©m portu.
2. **URL API**: OvÄ›Å™te, zda `REACT_APP_API_URL` odkazuje na vÃ¡Å¡ backendovÃ½ server
3. **DatabÃ¡ze**: Zkontrolujte, zda se ve sloÅ¾ce serveru vytvÃ¡Å™Ã­ databÃ¡ze SQLite.
4. **CORS**: UjistÄ›te se, Å¾e je CORS nakonfigurovÃ¡n pro vaÅ¡i frontendovou domÃ©nu.

### OdpovÄ›di na Discordu se nezobrazujÃ­

1. **ZÃ¡mÄ›r obsahu zprÃ¡vy**: UjistÄ›te se, Å¾e je tato moÅ¾nost povolena na portÃ¡lu pro vÃ½vojÃ¡Å™e Discordu.
2. **OprÃ¡vnÄ›nÃ­ bota**: OvÄ›Å™te, zda bot mÅ¯Å¾e ÄÃ­st zprÃ¡vy v kanÃ¡lu
3. **PÅ™ipojenÃ­ k databÃ¡zi**: Zkontrolujte protokoly serveru, zda neobsahujÃ­ chyby v databÃ¡zi.
4. **HlasovÃ¡nÃ­**: Frontend hlasuje kaÅ¾dÃ½ch 30 sekund â€“ zobrazenÃ­ odpovÄ›dÃ­ mÅ¯Å¾e trvat dÃ©le.

### PromÄ›nnÃ© prostÅ™edÃ­ nefungujÃ­

* **VÃ½voj**: Restartujte frontendovÃ© i backendovÃ© servery
* **Produkce**: Znovu nasaÄte frontend i backend se sprÃ¡vnÃ½mi promÄ›nnÃ½mi prostÅ™edÃ­.
* **PÅ™edpona**: PÅ™edponu `REACT_APP_` pouÅ¾Ã­vejte pouze pro promÄ›nnÃ© frontendu

### ProblÃ©my s databÃ¡zÃ­

1. **OprÃ¡vnÄ›nÃ­ k souborÅ¯m**: ZajistÄ›te, aby server mohl zapisovat do adresÃ¡Å™e databÃ¡ze
2. **MÃ­sto na disku**: Zkontrolujte dostupnÃ© mÃ­sto na disku pro databÃ¡zi SQLite
3. **Protokoly serveru**: Zkontrolujte konzoli serveru, zda nedoÅ¡lo k chybÃ¡m v pÅ™ipojenÃ­ k databÃ¡zi.

## BezpeÄnostnÃ­ aspekty

* **Token bota**: UdrÅ¾ujte svÅ¯j token bota v tajnosti a nikdy ho neposkytujte systÃ©mu sprÃ¡vy verzÃ­.
* **OmezenÃ­ rychlosti**: Discord mÃ¡ omezenÃ­ rychlosti pro boty (na rozdÃ­l od webhookÅ¯)
* **OvÄ›Å™enÃ­ vstupu**: Frontend i backend ovÄ›Å™ujÃ­ vstup uÅ¾ivatele.
* **ZabezpeÄenÃ­ databÃ¡ze**: DatabÃ¡ze SQLite by mÄ›la bÃ½t chrÃ¡nÄ›na sprÃ¡vnÃ½mi oprÃ¡vnÄ›nÃ­mi k souborÅ¯m
* **ZabezpeÄenÃ­ API**: ZvaÅ¾te implementaci omezenÃ­ rychlosti na koncovÃ½ch bodech API
* **CORS**: SprÃ¡vnÃ¡ konfigurace CORS pro vaÅ¡i produkÄnÃ­ domÃ©nu

## Architektura

```
Frontend webovÃ½ch strÃ¡nek â†â†’ Express API â†â†’ Discord Bot â†â†’ Discord Server
                    â†“
                DatabÃ¡ze SQLite
```

## Struktura souboru

```
project/
â”œâ”€â”€ src/components/DiscordComments/ # FrontendovÃ¡ komponenta
â”œâ”€â”€ server/ # BackendovÃ½ server
â”‚ â”œâ”€â”€ api.js # Express API server
â”‚ â”œâ”€â”€ discord-bot.js # Logika Discord bota
â”‚ â”œâ”€â”€ database.js # DatabÃ¡zovÃ© funkce SQLite
â”‚ â””â”€â”€ package.json # ZÃ¡vislosti serveru
â””â”€â”€ docs/Discord/Docs/ # Dokumentace
```

## Podpora prohlÃ­Å¾eÄÅ¯

Komponenta komentÃ¡Å™Å¯ na Discordu funguje ve vÅ¡ech modernÃ­ch prohlÃ­Å¾eÄÃ­ch, kterÃ© podporujÃ­:

* API pro naÄÃ­tÃ¡nÃ­ ES6
* Reagovat 18+
* CSS mÅ™Ã­Å¾ka a flexbox
* LokÃ¡lnÃ­ ÃºloÅ¾iÅ¡tÄ› (pro perzistenci formulÃ¡Å™e)
