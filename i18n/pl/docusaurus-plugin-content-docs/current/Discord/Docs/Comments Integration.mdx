---
title: Integracja komentarzy
description: Kompletny przewodnik po integracji dwukierunkowych komentarzy Discord z Docusaurus, obejmujÄ…cy konfiguracjÄ™, ustawienia i rozwiÄ…zywanie problemÃ³w.
image: /img/social/discord-social.jpg
sidebar_position: 2
---

# Integracja komentarzy Discord

Ta strona dokumentacji obejmuje **dwukierunkowÄ… integracjÄ™ komentarzy Discord**, ktÃ³ra umoÅ¼liwia odwiedzajÄ…cym wysyÅ‚anie komentarzy do serwera Discord ORAZ wyÅ›wietlanie odpowiedzi Discord na stronie internetowej obok istniejÄ…cych komentarzy Giscus opartych na GitHubie.

## Cechy

- **Komunikacja dwukierunkowa**: Komentarze na stronie â†’ Discord, odpowiedzi na Discordzie â†’ Strona internetowa
- **PodwÃ³jny system komentarzy**: komentarze Giscus (oparte na GitHubie) i Discord dziaÅ‚ajÄ… razem
- **Bogate osadzenia Discord**: Komentarze pojawiajÄ… siÄ™ jako sformatowane osadzenia z kontekstem caÅ‚ej strony
- **ZarzÄ…dzanie wÄ…tkami**: automatyczne tworzenie wÄ…tkÃ³w w celu uporzÄ…dkowania odpowiedzi
- **Aktualizacje w czasie rzeczywistym**: Strona internetowa automatycznie wyÅ›wietla odpowiedzi Discord
- **Kontekst caÅ‚ej strony**: Komentarze obejmujÄ… tytuÅ‚ strony, adres URL i kontekst nawigacji
- **Awatary uÅ¼ytkownikÃ³w**: odpowiedzi Discord pokazujÄ… awatary i nazwy uÅ¼ytkownikÃ³w
- **Responsywny projekt**: DziaÅ‚a zarÃ³wno na komputerach stacjonarnych, jak i urzÄ…dzeniach mobilnych

## Instrukcje konfiguracji

### 1. UtwÃ³rz bota Discord

1. PrzejdÅº do [Portalu programistÃ³w Discord](https://discord.com/developers/applications)
2. UtwÃ³rz nowÄ… aplikacjÄ™
3. PrzejdÅº do sekcji â€Botâ€ i utwÃ³rz bota
4. Skopiuj token bota
5. W sekcji â€Intencje bramy uprzywilejowanejâ€ wÅ‚Ä…cz:
   - **Intencja treÅ›ci wiadomoÅ›ci**
   - **Intencja czÅ‚onkÃ³w serwera** (opcjonalnie)

### 7. WdraÅ¼anie konfiguracji

TwÃ³j bot potrzebuje nastÄ™pujÄ…cych uprawnieÅ„:

- Przeczytaj wiadomoÅ›ci
- WyÅ›lij wiadomoÅ›ci
- UtwÃ³rz wÄ…tki publiczne
- WysyÅ‚aj wiadomoÅ›ci w wÄ…tkach
- Przeczytaj historiÄ™ wiadomoÅ›ci
- UÅ¼yj poleceÅ„ ukoÅ›nika (opcjonalnie)

### 6. Uruchom serwer zaplecza

1. PrzejdÅº do OAuth2 > Generator adresÃ³w URL
2. Wybierz zakres â€botâ€
3. Wybierz uprawnienia wymienione powyÅ¼ej
4. UÅ¼yj wygenerowanego adresu URL, aby zaprosiÄ‡ bota na swÃ³j serwer

### 5. Zainstaluj zaleÅ¼noÅ›ci serwera

#### Front-end (.env)

```env
# Konfiguracja bota Discord
DISCORD_BOT_TOKEN=tutaj wpisz token_bota
DISCORD_CHANNEL_ID=tutaj wpisz identyfikator_twojego_kanaÅ‚u

# Konfiguracja API
REACT_APP_API_URL=http://localhost:3001

# Konfiguracja kontekstu Discord
DISCORD_CONTEXT_LEVEL=peÅ‚ny
DISCORD_SHOW_BREADCRUMBS=prawda
DISCORD_SHOW_SECTION_INFO=prawda
DISCORD_SITE_NAME=Nazwa Twojej witryny
```

#### Serwer zaplecza (server/.env)

```env
# Konfiguracja bota Discord
DISCORD_BOT_TOKEN=tutaj_token_bota
DISCORD_CHANNEL_ID=tutaj_id_twojego_kanaÅ‚u

# Konfiguracja API
PORT=3001

# Konfiguracja kontekstu Discord
DISCORD_CONTEXT_LEVEL=peÅ‚ny
DISCORD_SHOW_PAGE_CONTEXT=prawda
DISCORD_SHOW_BREADCRUMBS=prawda
DISCORD_SHOW_SECTION_INFO=prawda
DISCORD_SHOW_PAGE_PATH=false
DISCORD_SHOW_TIMESTAMP=true
DISCORD_SHOW_AUTHOR_FIELD=true
DISCORD_CREATE_THREADS=true
DISCORD_THREAD_DURATION=1440
DISCORD_SITE_NAME=Nazwa Twojej witryny
```

:::ostrzeÅ¼enie Uwaga dotyczÄ…ca bezpieczeÅ„stwa

- Nigdy nie przekazuj plikÃ³w `.env` do systemu kontroli wersji
- UÅ¼yj zmiennych Å›rodowiskowych w Å›rodowisku produkcyjnym
- Zadbaj o bezpieczeÅ„stwo swojego tokena bota
  :::

### 6. Start the Backend Server

```bash
serwer cd
instalacja npm
```

### 6. Start the Backend Server

```bash
# RozwÃ³j
npm run dev

# Produkcja
npm start
```

### 7. 7. Deploy Configuration

W przypadku wdroÅ¼eÅ„ produkcyjnych naleÅ¼y ustawiÄ‡ zmienne Å›rodowiskowe na platformie hostingowej:

- **Frontend**: Ustaw `REACT_APP_API_URL` na adres URL swojego produkcyjnego interfejsu API
- **Backend**: WdrÃ³Å¼ folder serwera z tokenem bota i identyfikatorem kanaÅ‚u
- **Baza danych**: Baza danych SQLite zostanie utworzona automatycznie
- **Kontekst**: Skonfiguruj poziom kontekstu i opcje Discorda zgodnie ze swoimi preferencjami

## Jak to dziaÅ‚a

### PeÅ‚ny przepÅ‚yw dwukierunkowy

1. **Komentarz na stronie internetowej**: UÅ¼ytkownik przesyÅ‚a komentarz za pomocÄ… formularza na stronie internetowej
2. **WiadomoÅ›Ä‡ Discord**: Bot wysyÅ‚a sformatowany osadzony element do kanaÅ‚u Discord z peÅ‚nym kontekstem strony
3. **Tworzenie wÄ…tkÃ³w**: Bot automatycznie tworzy wÄ…tek w celu uporzÄ…dkowania odpowiedzi
4. **Odpowiedzi Discord**: UÅ¼ytkownicy Discord odpowiadajÄ… w wÄ…tku lub na wiadomoÅ›Ä‡
5. **Magazynowanie bazy danych**: Bot przechowuje wszystkie komentarze i odpowiedzi w bazie danych SQLite
6. **WyÅ›wietlanie witryny**: Ankiety interfejsu API sÄ… przeprowadzane co 30 sekund i wyÅ›wietlane sÄ… odpowiedzi Discord

### Format wiadomoÅ›ci Discord

Osadzone elementy Discord obejmujÄ…:

- **Title**: "ğŸ’¬ New Comment: \{Page Title}"
- **Opis**: Rzeczywista treÅ›Ä‡ komentarza
- **Autor**: ImiÄ™ komentujÄ…cego
- **URL**: Klikalny link do konkretnej strony
- **Pole strony**: Pokazuje tytuÅ‚ strony z klikalnym linkiem
- **Znacznik czasu**: Kiedy komentarz zostaÅ‚ opublikowany
- **WÄ…tek**: Automatycznie utworzony wÄ…tek do odpowiedzi

### WyÅ›wietlanie witryny

Na stronie internetowej pokazano:

- **Oryginalne komentarze**: ZgÅ‚oszenia za pomocÄ… formularzy na stronie internetowej
- **Odpowiedzi Discord**: Odpowiedzi uÅ¼ytkownikÃ³w Discord z awatarami i nazwami uÅ¼ytkownikÃ³w
- **Aktualizacje w czasie rzeczywistym**: automatyczne sprawdzanie nowych odpowiedzi
- **Rozmowy wÄ…tkowe**: Zorganizowana struktura komentarzy â†’ odpowiedzi

## Konfiguracja kontekstu

### Poziomy kontekstu

Skonfiguruj iloÅ›Ä‡ kontekstu wyÅ›wietlanÄ… w wiadomoÅ›ciach Discord:

#### `DISCORD_CONTEXT_LEVEL=minimal`

- **Pokazuje**: Tylko tytuÅ‚ strony i treÅ›Ä‡ komentarza
- **Przypadek uÅ¼ycia**: Czyste, proste wiadomoÅ›ci bez dodatkowego kontekstu

#### `DISCORD_CONTEXT_LEVEL=podstawowy`

- **Pokazuje**: tytuÅ‚ strony, treÅ›Ä‡ komentarza i klikalny adres URL strony
- **Przypadek uÅ¼ycia**: Umiarkowany kontekst z istotnymi informacjami

#### `DISCORD_CONTEXT_LEVEL=full` (domyÅ›lne)

- **Pokazuje**: Wszystkie informacje kontekstowe, w tym Å›cieÅ¼ki nawigacyjne, sekcje, znaczniki czasu
- **Przypadek uÅ¼ycia**: Maksymalny kontekst dla szczegÃ³Å‚owych dyskusji

#### `DISCORD_CONTEXT_LEVEL=niestandardowy`

- **Pokazuje**: Tylko elementy kontekstu, ktÃ³re wÅ‚Ä…czasz indywidualnie
- **Przypadek uÅ¼ycia**: DokÅ‚adna kontrola nad tym, co siÄ™ wyÅ›wietla

### Indywidualne kontrole kontekstowe

UÅ¼ywajÄ…c `DISCORD_CONTEXT_LEVEL=custom` moÅ¼esz kontrolowaÄ‡ kaÅ¼dy element:

```env
DISCORD_SHOW_PAGE_CONTEXT=true # PokaÅ¼ tytuÅ‚ strony i pole adresu URL
DISCORD_SHOW_BREADCRUMBS=true # PokaÅ¼ Å›cieÅ¼kÄ™ nawigacji
DISCORD_SHOW_SECTION_INFO=true # PokaÅ¼ sekcjÄ™ gÅ‚Ã³wnÄ… (Docker, Nextcloud itp.)
DISCORD_SHOW_PAGE_PATH=false # PokaÅ¼ peÅ‚nÄ… Å›cieÅ¼kÄ™ URL
DISCORD_SHOW_TIMESTAMP=true # PokaÅ¼, kiedy komentarz zostaÅ‚ opublikowany
DISCORD_SHOW_AUTHOR_FIELD=true # PokaÅ¼ nazwÄ™ komentujÄ…cego jako autora osadzenia
```

### Konfiguracja wÄ…tku

```env
DISCORD_CREATE_THREADS=true # UtwÃ³rz wÄ…tki dla odpowiedzi
DISCORD_THREAD_DURATION=1440 # Czas automatycznego archiwizowania wÄ…tku (w minutach)
DISCORD_SITE_NAME=Nazwa Twojej witryny # Nazwa witryny w stopce
```

### PrzykÅ‚adowe wyniki kontekstowe

**Minimalny kontekst:**

```
Przewodnik po instalacji Dockera
â€Ten samouczek byÅ‚ naprawdÄ™ pomocny! Jak poradziÄ‡ sobie z konfliktami portÃ³w?â€
```

**Podstawowy kontekst:**

```
ğŸ’¬ Przewodnik po instalacji Dockera
â€Ten samouczek byÅ‚ naprawdÄ™ pomocny! Jak poradziÄ‡ sobie z konfliktami portÃ³w?â€
[Link do strony]
```

**PeÅ‚ny kontekst:**

```
ğŸ’¬ Nowy komentarz: Przewodnik po instalacji Dockera
ğŸ‘¤ John Doe
â€Ten samouczek byÅ‚ naprawdÄ™ pomocny! Jak poradziÄ‡ sobie z konfliktami portÃ³w?â€

ğŸ“„ Strona: Przewodnik po instalacji Dockera
ğŸ“ Nawigacja: Docker > Dokumentacja > Instalowanie Dockera
ğŸ“‚ Sekcja: Docker
ğŸ”— ÅšcieÅ¼ka: /Docker/Docs/Installing%20Docker/Docker%20Engine

Nazwa Twojej witryny â€¢ System komentarzy
```

## Personalizacja

### Stylizacja

Komponent komentarzy Discord wykorzystuje moduÅ‚y CSS. MoÅ¼esz dostosowaÄ‡ wyglÄ…d poprzez modyfikacjÄ™:

```
src/components/DiscordComments/styles.module.css
```

### Format wiadomoÅ›ci

Aby dostosowaÄ‡ format osadzania Discorda, edytuj obiekt `discordMessage` w:

```
src/components/DiscordComments/index.tsx
```

### Umieszczenie komponentÃ³w

Komentarze Discorda domyÅ›lnie pojawiajÄ… siÄ™ pod komentarzami Giscusa. Aby to zmieniÄ‡, zmodyfikuj:

```
src/theme/DocItem/Layout/index.js
```

## RozwiÄ…zywanie problemÃ³w

### Bot nie odpowiada

1. **SprawdÅº token bota**: Upewnij siÄ™, Å¼e `DISCORD_BOT_TOKEN` jest poprawny
2. **SprawdÅº uprawnienia**: Upewnij siÄ™, Å¼e bot ma wymagane uprawnienia na kanale
3. **SprawdÅº identyfikator kanaÅ‚u**: Upewnij siÄ™, Å¼e `DISCORD_CHANNEL_ID` jest poprawny
4. **Bot na serwerze**: SprawdÅº, czy bot faktycznie znajduje siÄ™ na Twoim serwerze Discord

### Komentarze siÄ™ nie pojawiajÄ…

1. **Serwer dziaÅ‚a**: SprawdÅº, czy serwer zaplecza dziaÅ‚a na prawidÅ‚owym porcie
2. **URL API**: SprawdÅº, czy `REACT_APP_API_URL` wskazuje na serwer zaplecza
3. **Baza danych**: SprawdÅº, czy baza danych SQLite jest tworzona w folderze serwera
4. **CORS**: Upewnij siÄ™, Å¼e CORS jest skonfigurowany dla Twojej domeny front-end

### Odpowiedzi Discord nie sÄ… wyÅ›wietlane

1. **Intencja treÅ›ci wiadomoÅ›ci**: Upewnij siÄ™, Å¼e ta opcja jest wÅ‚Ä…czona w portalu programistÃ³w Discord
2. **Uprawnienia bota**: SprawdÅº, czy bot moÅ¼e odczytywaÄ‡ wiadomoÅ›ci na kanale
3. **PoÅ‚Ä…czenie z bazÄ… danych**: SprawdÅº logi serwera pod kÄ…tem bÅ‚Ä™dÃ³w bazy danych
4. **Ankieta**: Ankiety front-endowe przeprowadzane sÄ… co 30 sekund â€“ odpowiedzi mogÄ… pojawiÄ‡ siÄ™ dopiero po pewnym czasie

### Zmienne Å›rodowiskowe nie dziaÅ‚ajÄ…

- **RozwÃ³j**: Uruchom ponownie serwery front-end i back-end
- **Produkcja**: Ponowne wdroÅ¼enie front-endu i back-endu z poprawnymi zmiennymi Å›rodowiskowymi
- **Prefiks**: UÅ¼ywaj prefiksu `REACT_APP_` tylko w przypadku zmiennych front-end

### Problemy z bazÄ… danych

1. **Uprawnienia do plikÃ³w**: Upewnij siÄ™, Å¼e serwer moÅ¼e zapisywaÄ‡ w katalogu bazy danych
2. **Miejsce na dysku**: SprawdÅº dostÄ™pnÄ… przestrzeÅ„ dyskowÄ… dla bazy danych SQLite
3. **Logi serwera**: SprawdÅº konsolÄ™ serwera pod kÄ…tem bÅ‚Ä™dÃ³w poÅ‚Ä…czenia z bazÄ… danych

## Zagadnienia bezpieczeÅ„stwa

- **Token bota**: Utrzymuj swÃ³j token bota w tajemnicy i nigdy nie udostÄ™pniaj go kontroli wersji
- **Ograniczanie przepustowoÅ›ci**: Discord ma limity przepustowoÅ›ci dla botÃ³w (inne niÅ¼ w przypadku webhookÃ³w)
- **Weryfikacja danych wejÅ›ciowych**: ZarÃ³wno front-end, jak i back-end weryfikujÄ… dane wejÅ›ciowe uÅ¼ytkownika
- **BezpieczeÅ„stwo bazy danych**: Baza danych SQLite powinna byÄ‡ chroniona odpowiednimi uprawnieniami do plikÃ³w
- **BezpieczeÅ„stwo interfejsu API**: RozwaÅ¼ wdroÅ¼enie ograniczenia przepustowoÅ›ci w punktach koÅ„cowych interfejsu API
- **CORS**: Skonfiguruj CORS prawidÅ‚owo dla swojej domeny produkcyjnej

## Architektura

```
Frontend strony internetowej â†â†’ Express API â†â†’ Discord Bot â†â†’ Serwer Discord
                    â†“
                Baza danych SQLite
```

## Struktura pliku

```
project/
â”œâ”€â”€ src/components/DiscordComments/ # Komponent frontend
â”œâ”€â”€ server/ # Serwer backend
â”‚ â”œâ”€â”€ api.js # Serwer Express API
â”‚ â”œâ”€â”€ discord-bot.js # Logika bota Discord
â”‚ â”œâ”€â”€ database.js # Funkcje bazy danych SQLite
â”‚ â””â”€â”€ package.json # ZaleÅ¼noÅ›ci serwera
â””â”€â”€ docs/Discord/Docs/ # Dokumentacja
```

## ObsÅ‚uga przeglÄ…darki

Komponent komentarzy Discord dziaÅ‚a we wszystkich nowoczesnych przeglÄ…darkach, ktÃ³re obsÅ‚ugujÄ…:

- API pobierania ES6
- Reaguj 18+
- Siatka CSS i Flexbox
- PamiÄ™Ä‡ lokalna (do utrwalania formularza)
