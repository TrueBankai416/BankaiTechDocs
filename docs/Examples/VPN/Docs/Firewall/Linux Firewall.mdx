---
title: Linux Firewall Rules
tags:
    - VPN
    - Firewall
keywords: [VPN, Firewall]
last_update:
  author: BankaiTech
---
import BuyMeACoffeeButton from '@site/src/components/BuyMeACoffeeButton';

## UFW Commands to Create VPN Firewall Rules

:::info
**Note:** VPN server IP addresses and subnets may differ depending on your VPN provider. Replace the example IP ranges with your actual VPN server addresses.
:::

### Set Default Policies
```bash
sudo ufw default deny incoming
sudo ufw default deny outgoing
```

### Allow VPN Traffic
```bash
# Allow traffic on VPN tunnel interface
sudo ufw allow in on tun0
sudo ufw allow out on tun0

# Allow SSH access (inbound)
sudo ufw allow in 22/tcp

# Allow local network traffic
sudo ufw allow in from 192.168.1.0/24
sudo ufw allow out to 192.168.1.0/24

# Block inbound traffic from your public IP
sudo ufw deny from <PUBLIC_IP>
# Block outbound traffic to your public IP  
sudo ufw deny to <PUBLIC_IP>
```

### Allow VPN Server Connections
```bash
# Allow DNS queries (both TCP and UDP)
sudo ufw allow out 53/udp
sudo ufw allow out 53/tcp

# Option 1: Allow OpenVPN to any destination (less secure but simpler)
# sudo ufw allow out 1194/udp

# Option 2: Allow specific VPN server subnets only (more secure - recommended)
# Replace with your VPN provider's server subnets
sudo ufw allow out proto udp to 185.203.219.0/24 port 1194
```

### Enable UFW
```bash
sudo ufw enable
# Or if UFW is already enabled, reload the rules:
# sudo ufw reload
```

## Current UFW Status Example

```bash
root@MediaManagement:~# ufw status
Status: active

To                         Action      From
--                         ------      ----
Anywhere on tun0           ALLOW       Anywhere                   # OpenVPN TUN in
22                         ALLOW       Anywhere                  
Anywhere                   DENY        <PUBLIC_IP>             
<PUBLIC_IP>                DENY        Anywhere                  
192.168.1.0/24             ALLOW       Anywhere                  

Anywhere                   ALLOW OUT   Anywhere on tun0           # OpenVPN TUN out
53/udp                     ALLOW OUT   Anywhere                   # DNS
192.168.1.0/24             ALLOW OUT   Anywhere                  
185.203.219.0/24 1194/udp  ALLOW OUT   Anywhere                   # NordVPN server
53/tcp                     ALLOW OUT   Anywhere                   # DNS
```

<BuyMeACoffeeButton />
