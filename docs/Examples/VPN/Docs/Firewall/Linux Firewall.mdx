---
title: Linux Firewall Rules
tags:
    - VPN
    - Firewall
keywords: [VPN, Firewall]
last_update:
  author: BankaiTech
---
import BuyMeACoffeeButton from '@site/src/components/BuyMeACoffeeButton';

## UFW Commands to Create VPN Firewall Rules

:::info
**Note:** VPN server IP addresses and subnets may differ depending on your VPN provider. Replace the example IP ranges with your actual VPN server addresses.
:::

### Set Default Policies
```bash
sudo ufw default deny incoming
sudo ufw default deny outgoing
```

### Allow VPN Traffic
```bash
# Allow traffic on VPN tunnel interface
sudo ufw allow in on tun0
sudo ufw allow out on tun0

# Allow SSH access
sudo ufw allow 22

# Allow local network traffic
sudo ufw allow from 192.168.1.0/24
sudo ufw allow out to 192.168.1.0/24

# Block your public IP (replace <PUBLIC_IP> with your actual public IP)
sudo ufw deny from <PUBLIC_IP>
sudo ufw deny to <PUBLIC_IP>
```

### Allow VPN Server Connections
```bash
# Allow OpenVPN connection
sudo ufw allow out 1194/udp

# Allow DNS queries
sudo ufw allow out 53/udp
sudo ufw allow out 53/tcp

# Allow specific VPN server subnets (example for NordVPN - replace with your VPN provider's servers)
sudo ufw allow out to 185.203.219.0/24 port 1194 proto udp
sudo ufw allow out to 89.187.160.0/24 port 1194 proto udp
sudo ufw allow out to 194.127.199.0/24 port 1194 proto udp
```

### Enable UFW
```bash
sudo ufw enable
```

## Current UFW Status Example

```bash
root@MediaManagement:~# ufw status
Status: active

To                         Action      From
--                         ------      ----
Anywhere on tun0           ALLOW       Anywhere                   # OpenVPN TUN in
22                         ALLOW       Anywhere                  
Anywhere                   DENY        <PUBLIC_IP>             
<PUBLIC_IP>                DENY        Anywhere                  
192.168.1.0/24             ALLOW       Anywhere                  

Anywhere                   ALLOW OUT   Anywhere on tun0           # OpenVPN TUN out
1194/udp                   ALLOW OUT   Anywhere                   # OpenVPN
53/udp                     ALLOW OUT   Anywhere                   # DNS
192.168.1.0/24             ALLOW OUT   Anywhere                  
185.203.219.0/24 1194/udp  ALLOW OUT   Anywhere                   # NordVPN servers
89.187.160.0/24 1194/udp   ALLOW OUT   Anywhere                   # NordVPN servers
194.127.199.0/24 1194/udp  ALLOW OUT   Anywhere                   # NordVPN servers
53/tcp                     ALLOW OUT   Anywhere                   # DNS
```
:::danger
Make sure you change the default policies
```bash
sudo ufw default deny incoming
```
```bash
sudo ufw default deny outgoing
```
:::

<BuyMeACoffeeButton />
